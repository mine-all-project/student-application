<!DOCTYPE html>
<html lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<meta name="renderer" content="webkit">
<title></title>
<link rel="stylesheet" href="css/pintuer.css">
<link rel="stylesheet" href="css/admin.css">
<script src="js/jquery.js"></script>
<script src="js/pintuer.js"></script>
</head>
<body>
<form method="post" action="" id="listform">
  	<div class="panel admin-panel">
	<div class="padding border-bottom">
		<ul class="search" style="padding-left:10px;">
	        <li> <a class="button border-main icon-plus-square-o" href="addWork"> 创建任务</a> </li>
		</ul> 
    </div>
    <div class="panel-head"><strong class="icon-reorder">任务列表</strong></div>
    <table class="table table-hover text-center">
      <tr>
        <th>任务编号</th>
        <th>任务名称</th>
        <th>任务简介</th>
        <th>执行人员</th>
        <th>任务赏金</th>
        <th>发布时间</th>
        <th>附件</th>
        <th>项目状态</th>
        <th>操作</th>
      </tr>
      
      <tbody data-th-each="model : ${works}">
        <tr>  
          <td data-th-text="${model.number}"></td>
          <td>
          	<font data-th-text="${model.name}"></font>
          </td>
          <td data-th-text="${model.info}"></td>
          <td data-th-text="${model.userName}"></td>
          <td data-th-text="${model.money}"></td>
          <td data-th-text="${model.insert_time}"></td>
          <td>
			<a class="button" data-th-href="'/file/'+${model.file}" data-th-download="${model.file}" style="padding: 4px 8px;">点击下载</a>
		  </td>
          <td data-th-if="${model.status==0}" style="color:red">待发布</td>
          <td data-th-if="${model.status==1}" style="color:#00CC99;">工作中</td>
          <td data-th-if="${model.status==2}" style="color:blue">待反馈</td>
          <td data-th-if="${model.status==3}" >已终止</td>
          <td data-th-if="${model.status==4}" >已完成</td>
          <td data-th-if="${model.status != 0 && model.status != 1 && model.status != 2 && model.status != 3 && model.status != 4}">未知</td>
          <td>
          	<div class="button-group" data-th-value="${model.id}">
          		<a data-th-if="${model.status==0}" class="button border-green" data-th-href="'startWork?id='+${model.id}" style="padding: 4px 8px;">立即发布</a>
          		<a data-th-if="${model.status==2}" class="button border-blue" onclick="updateWork(this,'feedbackWork');" style="padding: 4px 8px;">核验通过</a>
          		<a data-th-if="${model.status!=3 && model.status != 4}" class="button border-red" onclick="updateWork(this,'deleteWork');" style="padding: 4px 8px;">结束任务</a>
          	</div>
        </tr>
       </tbody>
    </table>
  </div>
</form>
<script>
	function updateWork(e,uri){
		var id = $($(e).parent()[0]).attr('value');
			 $.ajax({
	             type: "GET",
	             url: "/wskjglxt/"+uri,
	             data: {
	            	 id:id
	            	 },
	             dataType: "json",
	             success: 
	            	 function(e){
	            	 	window.location.reload();
	                  }
	         }); 
	}
</script>
</body>
</html>