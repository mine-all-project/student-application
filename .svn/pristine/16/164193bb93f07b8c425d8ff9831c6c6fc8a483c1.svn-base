package com.service;

import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.UUID;

import javax.servlet.http.HttpServletRequest;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import com.entity.User;
import com.entity.Work;
import com.mapper.Mapping1;

@Service
public class Service1 {
	@Autowired
	Mapping1 mapping1;
	public List<Work> getWorkListByUserId(HttpServletRequest request) {
		User user = (User) request.getSession().getAttribute("user");
		List<Work> works = mapping1.getWorkListByUserId(user.getId());
		return works;
	}
	
	public int subWork(Work work) {
		int status = mapping1.subWork(work);
		return status;
	}
	
	public User getUserInfoBySession(HttpServletRequest request) {
		User user = (User) request.getSession().getAttribute("user");
		return user;
	}

	public User getUserInfoById(String id) {
		User user = mapping1.getUserInfoById(id);
		return user;
	}

	public int savePwd(String id, String password, String new_password, String new_password_1) {
		int status = 0;
		if(new_password_1.equals(new_password)) {
			status = mapping1.savePwd(id,password,new_password);
		}else {
			status = 0;
		}
		return status;
	}

	public int subUpdateJob(String user_id,String old_id, String new_id) {
		Map<String,String> updateJob = new HashMap<String,String>(4);
		updateJob.put("id", UUID.randomUUID().toString());
		updateJob.put("user_id", user_id);
		updateJob.put("old_id", old_id);
		updateJob.put("new_id", new_id);
		int status = mapping1.subUpdateJob(updateJob);
		return status;
	}

	public Integer saveFree(String user_id, String info, String time,String jobNum) {
		Map<String,String> free = new HashMap<String,String>(4);
		free.put("id", UUID.randomUUID().toString());
		free.put("user_id", user_id);
		free.put("info", info);
		free.put("time", time);
		free.put("jobNum", jobNum);
		int status = mapping1.saveFree(free);
		return status;
	}

}
